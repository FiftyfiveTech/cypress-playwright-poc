name: Cypress test in Git
on: [push]
jobs:
  cypress-run:
    name: Test1
    runs-on: ubuntu-20.04
    environment: test
    strategy:
      matrix:
        node-version: [14.x]
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      # Install NPM dependencies, cache them correctly
      # and run all Cypress tests
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
         node-version: ${{ matrix.node-version }}
      - name: npm run deploy
        run: |
         npm install
      - name: Cypress run
        uses: cypress-io/github-action@v4
        env: # Or as an environment 
          CYPRESS_username: ${{ secrets.USERNAME }}
          CYPRESS_password: ${{ secrets.PASSWORD }}
        with:
          browser: chrome
          working-directory: ${{ github.workspace }}
#           install-command: npm install
          # build: npm i --legacy-peer-deps
          start: npm run cypress-run "cypress/integration/Test_specs/SalesForce.spec.ts --config-file cypress.json"
#       - name: test
      #   env: # Or as an environment 
      #     USERNAME: ${{ secrets.USERNAME }}
      #     PASSWORD: ${{ secrets.PASSWORD }}
      #   run: |
      #     echo "$USERNAME"
        
